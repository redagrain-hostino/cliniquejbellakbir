---
// Navigation items
const navItems = [
	{ label: "ACCUEIL", href: "/", active: true },
	{ label: "CONSULTATIONS | RDV EN LIGNE", href: "/contact" },
	{
		label: "SPÉCIALITÉS",
		href: "/specialites",
		children: [
			{ label: "Gynécologie", href: "/gynecologie" },
			{ label: "Obstétrique", href: "/obstetrique" },
			{ label: "Cancérologie", href: "/cancerologie" },
			{ label: "Chirurgie", href: "/chirurgie" },
		],
	},
	{ label: "NOTRE ÉQUIPE", href: "/nos-medecins/" },
];
---

<header id="site-header" class="site-header" role="banner">
	<!-- Top bar -->
	<div class="header-topbar">
		<div class="header-container">
			<span class="topbar-text">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="14"
					height="14"
					viewBox="0 0 24 24"
					fill="none"
					stroke="currentColor"
					stroke-width="2.5"
					stroke-linecap="round"
					stroke-linejoin="round"
					aria-hidden="true"
				>
					<path
						d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 11.8a19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 3.6 1h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 8.6a16 16 0 0 0 5.3 5.3l.96-.96a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 21 15z"
					></path>
				</svg>
				Urgences assurées 24/24h, 7/7 &nbsp;·&nbsp;
				<a href="tel:+212539949094">+212 5399-49094</a>
			</span>
			<span class="topbar-social">
				<a
					href="https://www.instagram.com/clinique_jbel_lakbir/"
					aria-label="Instagram"
					target="_blank"
					rel="noopener"
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="14"
						height="14"
						viewBox="0 0 24 24"
						fill="currentColor"
						aria-hidden="true"
					>
						<rect
							x="2"
							y="2"
							width="20"
							height="20"
							rx="5"
							ry="5"
							fill="none"
							stroke="currentColor"
							stroke-width="2"></rect>
						<circle
							cx="12"
							cy="12"
							r="4"
							fill="none"
							stroke="currentColor"
							stroke-width="2"></circle>
						<circle cx="17.5" cy="6.5" r="1" fill="currentColor"
						></circle>
					</svg>
				</a>
			</span>
		</div>
	</div>

	<!-- Main nav bar -->
	<div class="header-main">
		<div class="header-container">
			<!-- Logo -->
			<a
				href="/"
				class="header-logo"
				aria-label="Clinique Jbel Lakbir – Accueil"
			>
				<img
					src="https://www.cliniquejbellakbir.ma/wp-content/uploads/2023/09/jbel-logo.png"
					alt="Logo Clinique Jbel Lakbir"
					width="155"
					height="62"
					fetchpriority="high"
				/>
			</a>

			<!-- Desktop nav -->
			<nav
				class="header-nav"
				role="navigation"
				aria-label="Navigation principale"
			>
				<ul class="nav-list" role="list">
					{
						navItems.map((item) => (
							<li
								class={`nav-item${item.children ? " has-dropdown" : ""}${item.active ? " active" : ""}`}
							>
								<a href={item.href} class="nav-link">
									{item.label}
									{item.children && (
										<svg
											class="dropdown-chevron"
											xmlns="http://www.w3.org/2000/svg"
											width="10"
											height="10"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="3"
											stroke-linecap="round"
											stroke-linejoin="round"
											aria-hidden="true"
										>
											<polyline points="6 9 12 15 18 9" />
										</svg>
									)}
								</a>
								{item.children && (
									<ul class="dropdown-menu" role="list">
										{item.children.map((child) => (
											<li class="dropdown-item">
												<a href={child.href}>
													{child.label}
												</a>
											</li>
										))}
									</ul>
								)}
							</li>
						))
					}
				</ul>
			</nav>

			<!-- CTA button -->
			<a href="/contact" class="header-cta" id="header-rdv-btn">
				Prendre rendez-vous
			</a>

			<!-- Hamburger (mobile) -->
			<button
				class="hamburger"
				id="hamburger-btn"
				aria-label="Menu"
				aria-expanded="false"
				aria-controls="mobile-nav"
			>
				<span></span>
				<span></span>
				<span></span>
			</button>
		</div>
	</div>

	<!-- Mobile nav drawer -->
	<nav
		id="mobile-nav"
		class="mobile-nav"
		aria-label="Navigation mobile"
		aria-hidden="true"
	>
		<ul class="mobile-nav-list" role="list">
			{
				navItems.map((item) => (
					<li class="mobile-nav-item">
						<a
							href={item.children ? "#" : item.href}
							class={`mobile-nav-link${item.active ? " active" : ""}`}
						>
							{item.label}
						</a>
						{item.children && (
							<ul class="mobile-subnav">
								{item.children.map((child) => (
									<li>
										<a href={child.href}>{child.label}</a>
									</li>
								))}
							</ul>
						)}
					</li>
				))
			}
			<li>
				<a href="/contact" class="mobile-cta">Prendre rendez-vous</a>
			</li>
		</ul>
	</nav>
</header>

<style>
	/* ── Design tokens (from post-96.css + brand palette) ─────────────────── */
	:root {
		--clr-brand: #33a9b1;
		--clr-brand-dk: #22858c;
		--clr-dark: #022545;
		--clr-white: #ffffff;
		--clr-topbar-bg: #33a9b1;
		--clr-nav-bg: #ffffff;
		--clr-nav-text: #131d1e;
		--clr-shadow: rgba(0, 0, 0, 0.08);
		--font-body: "Poppins", sans-serif;
		--header-h: 80px;
		--topbar-h: 40px;
		--radius: 6px;
		--transition: 0.22s ease;
	}

	/* ── Base ─────────────────────────────────────────────────────────────── */
	.site-header {
		position: sticky;
		top: 0;
		z-index: 1000;
		font-family: var(--font-body);
	}

	.header-container {
		max-width: 1400px;
		margin-inline: auto;
		padding-inline: 20px;
		display: flex;
		align-items: center;
		gap: 12px;
	}

	/* ── Top bar ──────────────────────────────────────────────────────────── */
	.header-topbar {
		background: var(--clr-topbar-bg);
		height: var(--topbar-h);
	}

	.header-topbar .header-container {
		height: 100%;
		justify-content: space-between;
	}

	.topbar-text {
		color: var(--clr-white);
		font-size: 13.5px;
		display: flex;
		align-items: center;
		gap: 6px;
	}

	.topbar-text a {
		color: var(--clr-white);
		text-decoration: none;
		font-weight: 600;
		transition: opacity var(--transition);
	}

	.topbar-text a:hover {
		opacity: 0.8;
	}

	.topbar-social {
		display: flex;
		align-items: center;
		gap: 10px;
	}

	.topbar-social a {
		color: var(--clr-white);
		display: flex;
		align-items: center;
		opacity: 0.9;
		transition: opacity var(--transition);
	}

	.topbar-social a:hover {
		opacity: 1;
	}

	/* ── Main nav bar ─────────────────────────────────────────────────────── */
	.header-main {
		background: var(--clr-nav-bg);
		box-shadow: 0 2px 16px var(--clr-shadow);
		height: var(--header-h);
	}

	.header-main .header-container {
		height: 100%;
	}

	/* Logo */
	.header-logo {
		flex-shrink: 0;
		display: flex;
		align-items: center;
		order: 0;
	}

	.header-logo img {
		width: 155px;
		height: auto;
		display: block;
	}

	/* Desktop nav */
	.header-nav {
		flex: 1;
		display: flex;
		justify-content: center;
		order: 1;
	}

	.nav-list {
		list-style: none;
		margin: 0;
		padding: 0;
		display: flex;
		align-items: stretch;
		gap: 0;
		height: 100%;
	}

	.nav-item {
		position: relative;
		display: flex;
		align-items: stretch;
	}

	.nav-link {
		display: flex;
		align-items: center;
		gap: 4px;
		padding: 0 14px;
		font-size: 13.5px;
		font-weight: 600;
		letter-spacing: 0.03em;
		color: var(--clr-nav-text);
		text-decoration: none;
		white-space: nowrap;
		border-bottom: 3px solid transparent;
		transition:
			color var(--transition),
			border-color var(--transition);
		cursor: pointer;
	}

	.nav-link:hover,
	.nav-item.active .nav-link {
		color: var(--clr-brand);
		border-bottom-color: var(--clr-brand);
	}

	.dropdown-chevron {
		transition: transform var(--transition);
		flex-shrink: 0;
		margin-top: 1px;
	}

	.has-dropdown:hover .dropdown-chevron {
		transform: rotate(180deg);
	}

	/* Dropdown */
	.dropdown-menu {
		list-style: none;
		margin: 0;
		padding: 8px 0;
		position: absolute;
		top: 100%;
		left: 0;
		min-width: 200px;
		background: var(--clr-white);
		border-radius: var(--radius);
		box-shadow: 0 8px 28px rgba(0, 0, 0, 0.12);
		border-top: 3px solid var(--clr-brand);
		opacity: 0;
		visibility: hidden;
		transform: translateY(8px);
		transition:
			opacity var(--transition),
			transform var(--transition),
			visibility var(--transition);
		z-index: 200;
	}

	.has-dropdown:hover .dropdown-menu,
	.has-dropdown:focus-within .dropdown-menu {
		opacity: 1;
		visibility: visible;
		transform: translateY(0);
	}

	.dropdown-item a {
		display: block;
		padding: 10px 20px;
		font-size: 14px;
		font-weight: 500;
		color: var(--clr-nav-text);
		text-decoration: none;
		transition:
			background var(--transition),
			color var(--transition),
			padding var(--transition);
	}

	.dropdown-item a:hover {
		background: #f0fafb;
		color: var(--clr-brand);
		padding-left: 26px;
	}

	/* CTA button */
	.header-cta {
		order: 2;
		flex-shrink: 0;
		display: inline-flex;
		align-items: center;
		gap: 6px;
		padding: 10px 22px;
		background: var(--clr-brand);
		color: var(--clr-white);
		font-family: var(--font-body);
		font-size: 13.5px;
		font-weight: 600;
		border-radius: var(--radius);
		text-decoration: none;
		white-space: nowrap;
		transition:
			background var(--transition),
			transform var(--transition),
			box-shadow var(--transition);
		box-shadow: 0 4px 14px rgba(51, 169, 177, 0.35);
	}

	.header-cta:hover {
		background: var(--clr-brand-dk);
		transform: translateY(-1px);
		box-shadow: 0 6px 20px rgba(51, 169, 177, 0.45);
	}

	.header-cta:active {
		transform: translateY(0);
	}

	/* Hamburger */
	.hamburger {
		order: 3;
		display: none;
		flex-direction: column;
		justify-content: center;
		gap: 5px;
		width: 40px;
		height: 40px;
		background: none;
		border: none;
		cursor: pointer;
		padding: 4px;
		flex-shrink: 0;
	}

	.hamburger span {
		display: block;
		width: 100%;
		height: 2.5px;
		background: var(--clr-dark);
		border-radius: 2px;
		transition:
			transform var(--transition),
			opacity var(--transition);
		transform-origin: center;
	}

	.hamburger[aria-expanded="true"] span:nth-child(1) {
		transform: rotate(45deg) translate(5px, 5px);
	}
	.hamburger[aria-expanded="true"] span:nth-child(2) {
		opacity: 0;
		transform: scaleX(0);
	}
	.hamburger[aria-expanded="true"] span:nth-child(3) {
		transform: rotate(-45deg) translate(5px, -5px);
	}

	/* ── Mobile nav ───────────────────────────────────────────────────────── */
	.mobile-nav {
		display: none;
		background: var(--clr-white);
		border-top: 2px solid var(--clr-brand);
		box-shadow: 0 8px 20px var(--clr-shadow);
		max-height: 0;
		overflow: hidden;
		transition: max-height 0.35s ease;
	}

	.mobile-nav.open {
		max-height: 600px;
	}

	.mobile-nav-list {
		list-style: none;
		margin: 0;
		padding: 8px 0 12px;
	}

	.mobile-nav-link,
	.mobile-nav-item > a {
		display: block;
		padding: 12px 24px;
		font-size: 14px;
		font-weight: 600;
		color: var(--clr-nav-text);
		text-decoration: none;
		letter-spacing: 0.03em;
		transition:
			color var(--transition),
			background var(--transition);
	}

	.mobile-nav-link:hover,
	.mobile-nav-link.active {
		color: var(--clr-brand);
		background: #f0fafb;
	}

	.mobile-subnav {
		list-style: none;
		margin: 0;
		padding: 0 0 4px 32px;
	}

	.mobile-subnav li a {
		display: block;
		padding: 8px 12px;
		font-size: 13.5px;
		font-weight: 500;
		color: #555;
		text-decoration: none;
		border-left: 2px solid #e0e0e0;
		transition:
			color var(--transition),
			border-color var(--transition);
	}

	.mobile-subnav li a:hover {
		color: var(--clr-brand);
		border-color: var(--clr-brand);
	}

	.mobile-cta {
		display: block;
		margin: 12px 24px 4px;
		padding: 12px 20px;
		background: var(--clr-brand);
		color: var(--clr-white) !important;
		font-weight: 600;
		font-size: 14px;
		border-radius: var(--radius);
		text-align: center;
		text-decoration: none;
		transition: background var(--transition);
	}

	.mobile-cta:hover {
		background: var(--clr-brand-dk) !important;
	}

	/* ── Responsive ───────────────────────────────────────────────────────── */
	@media (max-width: 1024px) {
		.header-nav,
		.header-cta {
			display: none;
		}

		.hamburger {
			display: flex;
			margin-left: auto;
		}

		.mobile-nav {
			display: block;
		}
	}

	@media (max-width: 640px) {
		:root {
			--topbar-h: 36px;
		}

		.topbar-text {
			font-size: 12px;
		}

		.header-logo img {
			width: 130px;
		}
	}
</style>

<script>
	const hamburger = document.getElementById("hamburger-btn");
	const mobileNav = document.getElementById("mobile-nav");

	hamburger?.addEventListener("click", () => {
		const isOpen = mobileNav?.classList.toggle("open");
		hamburger.setAttribute("aria-expanded", String(isOpen));
		mobileNav?.setAttribute("aria-hidden", String(!isOpen));
	});

	// Close mobile nav on link click
	mobileNav?.querySelectorAll("a").forEach((link) => {
		link.addEventListener("click", () => {
			mobileNav.classList.remove("open");
			hamburger?.setAttribute("aria-expanded", "false");
			mobileNav.setAttribute("aria-hidden", "true");
		});
	});

	// Sticky scroll shadow enhancement
	const header = document.getElementById("site-header");
	window.addEventListener(
		"scroll",
		() => {
			header?.classList.toggle("scrolled", window.scrollY > 10);
		},
		{ passive: true },
	);
</script>
